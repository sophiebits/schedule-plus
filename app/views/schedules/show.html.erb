<% content_for :content do %>
<div class="main-aside">
  <% if current_user && current_user == @schedule.user%>
    <!--<a class="nav-schedules">All Schedules</a>-->
    <!--<%= form_tag '/schedules/add-course', :id => 'add-course', :method => :get do %>
      <%= text_field_tag :course, nil, :placeholder => '99101A' %>
      <%= submit_tag "Add" %>
    <% end %>-->
  <% end %>
  <% if controller.controller_name == 'friends' %>
    <a href="/friends" class="nav-friends">All Friends</a>
  <% end %>
  <span id="total-units">Total: <%= @schedule.units %> units</span>
  <ul class="schedule">
    
  </ul>
</div>
<div id="article">
  
  <div id="calendar-header">
		<div id="schedule-permalink-box">
    <div id="schedule-permalink">http://<%= request.host %><%= ':3000' if request.host == 'localhost' %>/schedules/<%= @schedule.id %></div>
		</div>
		<% if (@schedule.user && current_user && ((friends.exists? (@schedule.user)) || (@schedule.user == current_user))) %>
    <img src="http://graph.facebook.com/<%= @schedule.user.try(:uid) %>/picture"/>
    <h1><%= @schedule.user.try(:name) %></h1>
  <% end %>
  </div>
  <ul id="calendar">

  </ul>
<script src="/javascripts/jquery.ajaxmanager.js" type="text/javascript"></script> 
<script src="/javascripts/calendar.js" type="text/javascript"></script>
<%# if controller.action_name == 'show' %>
<script type="text/javascript">
$(document).ready(function() {
  var schedule = <%= @schedule.to_json.html_safe %>;
 addSchedule(schedule.scheduled_courses);
});
<% if !@schedule.valid_units %>
  var html = '<div id="import-warning" class="warning"><p>The following schedule cannot be imported because it has too many total units (over 100)</p>';
  $('#main-page #article').prepend(html);
<% end %>
</script>
<%# end %>
<% if current_user %>
<script type="text/javascript">
$('#main-content').delegate('.course, .section, .lecture','click',loadFriends);
</script>
<% end %>
</div>
<% end %>
<%= render :partial => 'partials/mainpage' %>
